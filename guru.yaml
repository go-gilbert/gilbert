version: 1.0
tasks:
  build:
  - plugin: build
    description: "Building project"
    vars:
      version: '1.0.0'
    params:
      variables:
        'main.Version': '{{version}}'

  build-windows:
  - plugin: build
    description: "Building project for Windows"
    vars:
      output: ./build
      version: '1.0.0'
    params:
      outputPath: {{ output }}/guru-win32
      params:
        stripDebugInfo: true
      target:
        os: windows
        arch: '386'
      variables:
        'main.Version': '{{version}}'

  bash-test:
    - plugin: shell
      params:
        command: git status
    - plugin: shell
      params:
        command: cat x
  win-cmd:
    - plugin: shell
      description: "windows check - command"
      params:
        command: whoami

    - plugin: shell
      description: "windows check - error handle"
      params:
        command: type foo

  # start bash on windows
  wsl:
    - plugin: shell
      description: "Command 2"
      params:
        rawOutput: true
        command: bash.exe

  # Run command in bash on windows
  wsl-task:
    - plugin: shell
      params:
        rawOutput: true
        shell: bash.exe
        shellExecParam: -c
        command: screenfetch
  test:
  - plugin: test
    params:
      items:
        - path: '*'
          coverage:
            threshold: 80.0
            exclude:
              - cli
